{"version":3,"file":"state.umd.js","sources":["../lib/Signal.js","../lib/createStore.js","../node_modules/mini-runner/mini-runner.min.js","../node_modules/mini-signals/src/mini-signals.js","../node_modules/eventemitter3/index.js","demo.js"],"sourcesContent":["function SignalListener (owner, fn, ctx, once) {\n  this.fn = fn\n  this.ctx = ctx || null\n  this.owner = owner\n  this.once = !!once\n}\n\nfunction removeNode (owner, node) {\n  if (node.prev) node.prev.next = node.next\n  if (node.next) node.next.prev = node.prev\n  node.ctx = node.fn = node.owner = null\n  if (node === owner._first) owner._first = node.next\n  if (node === owner._last) owner._last = node.prev\n}\n\n/**\n * Create a new Signal instance\n * @class\n * @constructor\n * @return {Signal} A new signal\n * @example\n * import { Signal } from '@internet/state'\n * const click = new Signal()\n * document.addEventListener('click', click.dispatch)\n *\n * class Component {\n *   constructor () {\n *     click.listen(this.onClick, this)\n *   }\n *\n *   onClick () {\n *     // `this` is the component instance\n *     console.log('clicked')\n *   }\n *\n *   dispose () {\n *     click.unlisten(this.onClick, this)\n *   }\n * }\n */\nfunction Signal () {}\n\n/**\n * Dispatches the signal to all listeners.\n * @method\n * @param {...*} [arguments] Arguments passed to each listeners (:warning: 5 maximum)\n */\nSignal.prototype.dispatch = function (a0, a1, a2, a3, a4) {\n  var node = this._first\n  while (node) {\n    node.fn.call(node.ctx, a0, a1, a2, a3, a4)\n    node.once && this.unlisten(node)\n    node = node.next\n  }\n}\n\n/**\n * Register a new listener\n * @method\n * @param {Function} callback Callback function\n * @param {*} [context] The context to bind the callback to\n * @return {SignalListener} A SignalListener instance containing bindings to the signal.\n */\nSignal.prototype.listen = function (fn, ctx, once) {\n  var node = new SignalListener(this, fn, ctx, once)\n  if (!this._first) {\n    this._first = node\n    this._last = node\n  } else {\n    this._last.next = node\n    node.prev = this._last\n    this._last = node\n  }\n  return node\n}\n\n/**\n * Register a new listener that will be executed only once.\n * @method\n * @param {Function} callback Callback function\n * @param {*} [context] The context to bind the callback to\n * @return {SignalListener} A SignalListener instance containing bindings to the signal.\n */\nSignal.prototype.listenOnce = function (fn, ctx) {\n  return this.listen(fn, ctx, true)\n}\n\n/**\n * Detach a listener from the signal\n * You can also pass\n * @method\n * @param {(Function|SignalListener)} callback The callback used when listening to the signal **OR** The SignalListener instance returned when listening the signal\n * @param {*} [context] The context used when listening to the signal (only when the 1st arg is a function)\n * @example\n * import { Signal } from '@internet/state'\n * const signal = new Signal()\n *\n * // Using the SignalListener binding (better performances)\n * const binding = signal.listen(() => {})\n * signal.unlisten(binding)\n *\n * // Using function\n * function listener () {}\n * signal.listen(listener)\n * signal.unlisten(listener)\n */\nSignal.prototype.unlisten = function (fn, ctx) {\n  if (fn instanceof SignalListener) return removeNode(this, fn)\n  if (!ctx) ctx = null\n  var node = this._first\n  while (node) {\n    if (node.fn === fn && node.ctx === ctx) removeNode(this, node)\n    node = node.next\n  }\n}\n\n/**\n * Remove all listeners attached to the signal instance\n * @method\n */\nSignal.prototype.unlistenAll = function () {\n  var node = this._first\n  this._first = this._last = null\n  while (node) {\n    removeNode(this, node)\n    node = node.next\n  }\n}\n\nexport default Signal\n","'use strict'\n\nimport Signal from './Signal'\n\n/**\n * StoreSignal created by [createStore](#createStore).\n * Inherits from [Signal](#Signal) - See its API for `listen` / `unlisten` methods\n *\n * :warning: `dispatch()` method from Signal is removed and replaced by a `set()` method\n * @param {*} initialValue Initial value\n * @augments Signal\n * @return {StoreSignal} StoreSignal instance\n */\nfunction StoreSignal (value) { this.current = value }\nStoreSignal.prototype = Object.create(Signal.prototype)\nStoreSignal.prototype.constructor = StoreSignal\nStoreSignal.prototype.dispatch = undefined\n\n/**\n * Change the stored value. Dispatch to all listeners the new value\n * @method\n * @param {*} newValue New value to store\n * @param {boolean} [force=false] Nothing is distpatched if the value doesn't change. Set force to true to `force` the dispatch.\n * @return {SignalListener} A SignalListener instance containing bindings to the signal.\n */\nStoreSignal.prototype.set = function (value, force) {\n  if (!force && this.current === value) return\n  this.current = value\n  var node = this._first\n  while (node) {\n    node.once && this.unlisten(node)\n    node.fn.call(node.ctx, this.current)\n    node = node.next\n  }\n}\n\n/**\n * Get current stored value\n * @method\n * @return {*} Current stored value\n */\nStoreSignal.prototype.get = function (value) {\n  return this.current\n}\n\n/**\n * Create a new store containing [StoreSignal](#StoreSignal) instances\n * @param {Object} state Initial state\n * @return {Object} Frozen object containing [StoreSignal](#StoreSignal) instances\n * @example\n * import { createStore } from '@internet/state'\n * const store = createStore({\n *   value: 0\n * })\n *\n * store.value.listen(v => console.log(`value is now ${v}`))\n * store.value.set(3)\n */\nfunction createStore (state) {\n  var signals = {}\n  for (var k in state) signals[k] = new StoreSignal(state[k])\n  signals = Object.freeze(signals)\n  return signals\n}\n\nexport default createStore\n","var MiniRunner=function(t){this.items=[],this._name=t},p=MiniRunner.prototype;p.emit=function(t,e,i,n,s,r,h,m){if(arguments.length>8)throw\"max arguments reached\";for(var u=this.items,o=this._name,p=0,a=u.length;p<a;p++)u[p][o](t,e,i,n,s,r,h,m);return this},p.dispatch=p.emit,p.run=p.emit,p.add=function(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this},p.remove=function(t){var e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this},p.contains=function(t){return this.items.indexOf(t)!==-1},p.removeAll=function(){return this.items.length=0,this},p.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperties(p,{empty:{get:function(){return 0===this.items.length}},name:{get:function(){return this._name}}}),module.exports=MiniRunner;","/* jshint -W097 */\n\nexport class MiniSignalBinding {\n\n  /**\n  * MiniSignalBinding constructor.\n  * @constructs MiniSignalBinding\n  * @param {Function} fn Event handler to be called.\n  * @param {Boolean} [once=false] Should this listener be removed after dispatch\n  * @param {Mixed} [thisArg] The context of the callback function.\n  * @api private\n  */\n  constructor (fn, once = false, thisArg) {\n    this._fn = fn;\n    this._once = once;\n    this._thisArg = thisArg;\n    this._next = this._prev = this._owner = null;\n  }\n\n  detach () {\n    if (this._owner === null) return false;\n    this._owner.detach(this);\n    return true;\n  }\n\n}\n\n/**\n* @private\n*/\nfunction _addMiniSignalBinding (self, node) {\n  if (!self._head) {\n    self._head = node;\n    self._tail = node;\n  } else {\n    self._tail._next = node;\n    node._prev = self._tail;\n    self._tail = node;\n  }\n\n  node._owner = self;\n\n  return node;\n}\n\nexport class MiniSignal {\n\n  /**\n  * MiniSignal constructor.\n  * @constructs MiniSignal\n  * @api public\n  *\n  * @example\n  * let mySignal = new MiniSignal();\n  * let binding = mySignal.add(onSignal);\n  * mySignal.dispatch('foo', 'bar');\n  * mySignal.detach(binding);\n  */\n  constructor () {\n    this._head = this._tail = undefined;\n  }\n\n  /**\n  * Return an array of attached MiniSignalBinding.\n  *\n  * @param {Boolean} [exists=false] We only need to know if there are handlers.\n  * @returns {MiniSignalBinding[]|Boolean} Array of attached MiniSignalBinding or Boolean if called with exists = true\n  * @api public\n  */\n  handlers (exists = false) {\n    let node = this._head;\n\n    if (exists) return !!node;\n\n    const ee = [];\n\n    while (node) {\n      ee.push(node);\n      node = node._next;\n    }\n\n    return ee;\n  }\n\n  /**\n  * Return true if node is a MiniSignalBinding attached to this MiniSignal\n  *\n  * @param {MiniSignalBinding} node Node to check.\n  * @returns {Boolean} True if node is attache to mini-signal\n  * @api public\n  */\n  has (node) {\n    if (!(node instanceof MiniSignalBinding)) {\n      throw new Error('MiniSignal#has(): First arg must be a MiniSignalBinding object.');\n    }\n\n    return node._owner === this;\n  }\n\n  /**\n  * Dispaches a signal to all registered listeners.\n  *\n  * @returns {Boolean} Indication if we've emitted an event.\n  * @api public\n  */\n  dispatch () {\n    let node = this._head;\n\n    if (!node) return false;\n\n    while (node) {\n      if (node._once) this.detach(node);\n      node._fn.apply(node._thisArg, arguments);\n      node = node._next;\n    }\n\n    return true;\n  }\n\n  /**\n  * Register a new listener.\n  *\n  * @param {Function} fn Callback function.\n  * @param {Mixed} [thisArg] The context of the callback function.\n  * @returns {MiniSignalBinding} The MiniSignalBinding node that was added.\n  * @api public\n  */\n  add (fn, thisArg = null) {\n    if (typeof fn !== 'function') {\n      throw new Error('MiniSignal#add(): First arg must be a Function.');\n    }\n    return _addMiniSignalBinding(this, new MiniSignalBinding(fn, false, thisArg));\n  }\n\n  /**\n  * Register a new listener that will be executed only once.\n  *\n  * @param {Function} fn Callback function.\n  * @param {Mixed} [thisArg] The context of the callback function.\n  * @returns {MiniSignalBinding} The MiniSignalBinding node that was added.\n  * @api public\n  */\n  once (fn, thisArg = null) {\n    if (typeof fn !== 'function') {\n      throw new Error('MiniSignal#once(): First arg must be a Function.');\n    }\n    return _addMiniSignalBinding(this, new MiniSignalBinding(fn, true, thisArg));\n  }\n\n  /**\n  * Remove binding object.\n  *\n  * @param {MiniSignalBinding} node The binding node that will be removed.\n  * @returns {MiniSignal} The instance on which this method was called.\n  * @api public */\n  detach (node) {\n    if (!(node instanceof MiniSignalBinding)) {\n      throw new Error('MiniSignal#detach(): First arg must be a MiniSignalBinding object.');\n    }\n    if (node._owner !== this) return this;  // todo: or error?\n\n    if (node._prev) node._prev._next = node._next;\n    if (node._next) node._next._prev = node._prev;\n\n    if (node === this._head) {  // first node\n      this._head = node._next;\n      if (node._next === null) {\n        this._tail = null;\n      }\n    } else if (node === this._tail) {  // last node\n      this._tail = node._prev;\n      this._tail._next = null;\n    }\n\n    node._owner = null;\n    return this;\n  }\n\n  /**\n  * Detach all listeners.\n  *\n  * @returns {MiniSignal} The instance on which this method was called.\n  * @api public\n  */\n  detachAll () {\n    let node = this._head;\n    if (!node) return this;\n\n    this._head = this._tail = null;\n\n    while (node) {\n      node._owner = null;\n      node = node._next;\n    }\n    return this;\n  }\n}\n\nexport default MiniSignal;\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { createStore, Signal } from '../lib'\nimport Runner from 'mini-runner'\nimport MiniSignal from 'mini-signals'\nimport EventEmitter from 'eventemitter3'\n\nclass Listener {\n  constructor () { this.time = 0 }\n  update () { this.time++ }\n}\n\nconst EVENTCOUNT = 1000\nconst DISPATCHCOUNT = 2000\n\nconst a = createStore({ updateStore: 0 })\nconst updateStore = a.updateStore\nconst updateRunner = new Runner('update')\nconst updateMiniSignal = new MiniSignal()\nconst updateEvent = new EventEmitter()\nconst updateSignal = new Signal()\nconst pre = document.querySelector('pre')\nlet listeners = []\n\nfor (let i = 0; i < EVENTCOUNT; i++) {\n  var listener = new Listener()\n  updateRunner.add(listener)\n  updateSignal.listen(listener.update, listener)\n  updateMiniSignal.add(listener.update, listener)\n  updateEvent.on('update', listener.update, listener)\n  updateStore.listen(listener.update, listener)\n  listeners.push(listener)\n}\n\nlet i\nlet start\nlet time\nlet cycles = DISPATCHCOUNT\n\npre.innerHTML += EVENTCOUNT + ' Events \\n'\npre.innerHTML += DISPATCHCOUNT + ' Dispatches \\n'\npre.innerHTML += '\\n---\\n\\n'\n\n// SIGNAL\nstart = performance.now()\nfor (i = 0; i < cycles; i++) updateSignal.dispatch()\ntime = performance.now() - start\npre.innerHTML += 'Signal ' + time + 'ms \\n'\n\n// SIGNALSTORE\nstart = performance.now()\nfor (i = 0; i < cycles; i++) updateStore.set(0, true)\ntime = performance.now() - start\npre.innerHTML += 'StoreSignal ' + time + 'ms \\n'\n\npre.innerHTML += '\\n---\\n\\n'\n\n//RUNNER\nstart = performance.now()\nfor (i = 0; i < cycles; i++) updateRunner.emit()\ntime = performance.now() - start;\npre.innerHTML += 'MiniRunner ' + time + 'ms \\n'\n\n// MINI-SIGNALS\nstart = performance.now()\nfor (i = 0; i < cycles; i++) updateMiniSignal.dispatch()\ntime = performance.now() - start\npre.innerHTML += 'mini-signals ' + time + 'ms \\n'\n\n// EVENTS\nstart = performance.now()\nfor (i = 0; i < cycles; i++) updateEvent.emit('update')\ntime = performance.now() - start\npre.innerHTML += 'EventEmitter3 ' + time + 'ms \\n'\n"],"names":["SignalListener","owner","fn","ctx","once","this","removeNode","node","prev","next","_first","_last","Signal","StoreSignal","value","current","prototype","dispatch","a0","a1","a2","a3","a4","call","unlisten","listen","listenOnce","unlistenAll","Object","create","constructor","undefined","set","force","get","MiniRunner","t","items","_name","p","emit","e","i","n","s","r","h","m","arguments","length","u","o","a","run","add","remove","push","indexOf","splice","contains","removeAll","destroy","defineProperties","empty","name","module","MiniSignalBinding","[object Object]","thisArg","_fn","_once","_thisArg","_next","_prev","_owner","detach","_addMiniSignalBinding","self","_head","_tail","has","hasOwnProperty","prefix","Events","EE","context","addListener","emitter","event","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","events","names","slice","getOwnPropertySymbols","concat","listeners","handlers","l","ee","Array","listenerCount","a5","args","len","removeListener","apply","j","on","removeAllListeners","off","prefixed","Listener","time","update","const","start","updateStore","state","signals","k","freeze","createStore","updateRunner","Runner","updateMiniSignal","exists","Error","updateEvent","updateSignal","pre","document","querySelector","innerHTML","EVENTCOUNT","DISPATCHCOUNT","performance","now"],"mappings":"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"}